{{define "layout"}}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{{.Title}}</title>
  <link href="/assets/app.css" rel="stylesheet">
</head>
<body class="bg-body-tertiary">
  <header class="navbar shadow-sm">
    <div class="nav-container">
      <button class="nav-toggle" type="button" aria-expanded="false" aria-controls="primary-nav" aria-label="Toggle navigation">
        <span class="nav-toggle-icon" aria-hidden="true"></span>
      </button>
      <a class="navbar-brand" href="/">Impulse Pause</a>
      <nav class="navbar-nav" id="primary-nav" aria-label="Primary">
        <a class="nav-link {{if eq .CurrentPath "/"}}active{{end}}" href="/">Dashboard</a>
        <a class="nav-link {{if eq .CurrentPath "/items/new"}}active{{end}}" href="/items/new">Add item</a>
        <a class="nav-link {{if eq .CurrentPath "/insights"}}active{{end}}" href="/insights">Insights</a>
        <a class="nav-link {{if eq .CurrentPath "/settings/profile"}}active{{end}}" href="/settings/profile">Settings</a>
        <a class="nav-link {{if eq .CurrentPath "/settings/tags"}}active{{end}}" href="/settings/tags">Tags</a>
        <a class="nav-link {{if eq .CurrentPath "/about"}}active{{end}}" href="/about">About</a>
      </nav>
      {{if .ActiveProfile}}<span class="profile-badge">{{.ActiveProfile}}</span>{{end}}
    </div>
  </header>

  <main class="container py-3 py-md-4" style="max-width: 720px;">
    {{if eq .ContentTemplate "index_content"}}
      {{template "index_content" .}}
    {{else if eq .ContentTemplate "items_new_content"}}
      {{template "items_new_content" .}}
    {{else if eq .ContentTemplate "profile_content"}}
      {{template "profile_content" .}}
    {{else if eq .ContentTemplate "insights_content"}}
      {{template "insights_content" .}}
    {{else if eq .ContentTemplate "about_content"}}
      {{template "about_content" .}}
    {{else if eq .ContentTemplate "switch_profile_content"}}
      {{template "switch_profile_content" .}}
    {{else if eq .ContentTemplate "tags_content"}}
      {{template "tags_content" .}}
    {{end}}
  </main>

  <script>
    (() => {
      const toggle = document.querySelector('.nav-toggle');
      const nav = document.querySelector('.navbar-nav');
      const mobileWidth = 900;
      if (!toggle || !nav) return;

      const closeMenu = () => {
        nav.classList.remove('is-open');
        toggle.setAttribute('aria-expanded', 'false');
      };

      toggle.addEventListener('click', () => {
        const isOpen = nav.classList.toggle('is-open');
        toggle.setAttribute('aria-expanded', isOpen ? 'true' : 'false');
      });

      window.addEventListener('resize', () => {
        if (window.innerWidth > mobileWidth) {
          closeMenu();
        }
      });
    })();
  </script>

  {{if eq .ScriptTemplate "index_script"}}
    {{template "index_script" .}}
  {{else if eq .ScriptTemplate "items_new_script"}}
    {{template "items_new_script" .}}
  {{end}}
</body>
</html>
{{end}}
